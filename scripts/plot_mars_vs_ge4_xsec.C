///////////////////////////////////////////////////////////////////////////////
// from here it looks that the fast component is close to 11%, not 20%
///////////////////////////////////////////////////////////////////////////////

/*
root [2] f_all->Integral(100,500)
(Double_t)9.92299436304063818e+01
root [3] f_fast->Integral(100,500)
(Double_t)1.14554964660606533e+01
*/

namespace {
  TF1* f_all;
  TF1* f_fast;
};


//-----------------------------------------------------------------------------
  const double npt_mars_0000 = 30;

  double data_mars_0000[2*npt_mars_0000] = {
0.0383844,0.00212273,
0.0712377,0.00934531,
0.124768,0.0305957  ,
0.178317,0.0979101  ,
0.252302,0.313382   ,
0.339873,1.04997    ,
0.475035,3.94434    ,
0.603497,12.9223    ,
0.779883,31.4905    ,
0.976873,62.5160    ,
1.13319,96.5451	    ,
1.45980,152.772	    ,
1.71158,210.696	    ,
1.92943,247.644	    ,
2.20182,278.235	    ,
2.40621,266.329	    ,
2.59015,260.763	    ,
2.74011,232.989	    ,
2.95818,208.302	    ,
3.16952,169.989	    ,
3.38091,129.552	    ,
3.59910,101.018	    ,
3.77639,80.5543	    ,
3.96744,54.7681	    ,
4.15164,38.9710	    ,
4.33586,27.1053	    ,
4.51329,18.4263	    ,
4.67030,12.2417	    ,
4.82734,7.77037	    ,
4.99805,4.71297           
  };

//-----------------------------------------------------------------------------
// MARS 3.5 deg about 10 GeV incident protons
//-----------------------------------------------------------------------------
  const double npt_mars_0035 = 28;

  double data_mars_0035[2*npt_mars_0035] = {
0.0583650,0.00230108,
0.108136,0.0128052  ,
0.157211,0.0402032  ,
0.199057,0.0895422  ,
0.247910,0.234076   ,
0.344529,0.654985   ,
0.393214,1.49245    ,
0.537850,5.49299    ,
0.647871,12.7955    ,
0.771375,26.5771    ,
0.969811,55.1455    ,
1.24985,101.932	    ,
1.47500,136.845	    ,
1.78871,183.494	    ,
2.11585,209.571	    ,
2.41563,218.489	    ,
2.66750,189.787	    ,
2.91256,164.871	    ,
3.14391,133.744	    ,
3.42281,96.6947	    ,
3.67435,63.8148	    ,
3.91226,42.1233	    ,
4.12960,24.8044	    ,
4.35381,15.2890	    ,
4.52352,9.43100	    ,
4.70689,5.95109	    ,
4.86292,3.50727	    ,
5.02568,1.92962     
                                              
  };

//-----------------------------------------------------------------------------
// MARS 10.5 deg about 10 GeV incident protons
//-----------------------------------------------------------------------------
const double npt_mars_0105 = 26;

  double data_mars_0105[2*npt_mars_0105] = {
0.0437668,0.00103276,
0.0871159,0.00791955,
0.136219,0.0254401  ,
0.185238,0.0762969  ,
0.254638,0.218518   ,
0.317114,0.571130   ,
0.413650,1.49204    ,
0.503318,3.72373    ,
0.627212,10.6570    ,
0.764396,23.1680    ,
0.901330,40.9879    ,
1.07218,64.6402	    ,
1.27020,95.1390	    ,
1.48832,106.359	    ,
1.76752,98.9186	    ,
2.00583,89.9669	    ,
2.27121,71.2962	    ,
2.51605,51.5702	    ,
2.76078,34.0376	    ,
2.99861,20.9763	    ,
3.20238,12.9331	    ,
3.37890,7.97700	    ,
3.56891,4.38711	    ,
3.73176,2.58530	    ,
3.85370,1.48985	    ,
3.92149,1.13088	    
                                               
  };


//-----------------------------------------------------------------------------
const double npt_mars_0610 = 16;

double data_mars_0610[2*npt_mars_0610] = {
  0.0274702,0.000114693,
  0.0358134,0.000403991,
  0.0579473,0.00163224 ,
  0.0933988,0.00512554 ,
  0.142558,0.0172363   ,
  0.232226,0.0430173   ,
  0.294368,0.0854225   ,
  0.390541,0.165713    ,
  0.493360,0.280181    ,
  0.623175,0.385365    ,
  0.848273,0.494203    ,
  0.998079,0.471113    ,
  1.14093,0.400562     ,
  1.16771,0.271314     ,
  1.20104,0.149536     ,
  1.21428,0.108508     
};

//-----------------------------------------------------------------------------
const double npt_mars_0970 = 18;
double data_mars_0970[2*npt_mars_0970] = {
0.0137351,0.000104676,
0.0216328,0.000255617,
0.0502167,0.000766830,
0.0788006,0.00230043 ,
0.134298,0.00524130  ,
0.223604,0.00971352  ,
0.332900,0.0124767   ,
0.462326,0.0124546   ,
0.564170,0.00944934  ,
0.659146,0.00684901  ,
0.733576,0.00453110  ,
0.801221,0.00306735  ,
0.882435,0.00198315  ,
0.956781,0.00122490  ,
1.02440,0.000810434  ,
1.06480,0.000548832  ,
1.12563,0.000371569  ,
1.15927,0.000263444  

};

//-----------------------------------------------------------------------------
// MARS 119 deg
//-----------------------------------------------------------------------------
  const double npt_mars_1190 = 17;

  double data_mars_1190[2*npt_mars_1190] = {
0.0137630,0.000107100,
0.0352009,0.000244130,
0.0360361,0.000485196,
0.0711535,0.00115759 ,
0.0993197,0.00246330 ,
0.167940,0.00371611  ,
0.263389,0.00397511  ,
0.365400,0.00346003  ,
0.439941,0.00250858  ,
0.493880,0.00158577  ,
0.554657,0.00102554  ,
0.601923,0.000726978 ,
0.642404,0.000527318 ,
0.689531,0.000333369 ,
0.750197,0.000196728 ,
0.790679,0.000142698 ,
0.831132,0.000101164 
                                                  
  };

//-----------------------------------------------------------------------------
const double npt_g4_0000 = 48;

double data_g4_0000[2*npt_g4_0000] = {
  0.0749237,0.00317885  ,
  0.126330,0.0100686    ,
  0.157335,0.0232401    ,
  0.168340,0.0561300    ,
  0.219821,0.190263     ,
  0.291227,0.575923     ,
  0.392809,1.90801      ,
  0.514340,5.77388      ,
  0.625947,19.1276      ,
  0.787478,52.8650      ,
  0.988731,104.058      ,
  1.21981,163.347	      ,
  1.41048,195.526	      ,
  1.64114,208.977	      ,
  1.84179,239.071	      ,
  2.09266,299.304	      ,
  2.36351,350.097	      ,
  2.61416,357.596	      ,
  2.89469,304.764	      ,
  3.09496,248.365	      ,
  3.35521,172.715	      ,
  3.58536,117.442	      ,
  3.86545,68.1480	      ,
  4.10545,39.5532	      ,
  4.29527,21.9479	      ,
  4.56509,10.1589	      ,
  4.74466,4.59940	      ,
  4.96444,2.27897	      ,
  5.15398,0.986119      ,
  5.33365,0.488725      ,
  5.50350,0.290259      ,
  5.63332,0.184529      ,
  5.83277,0.0713066     ,
  5.86251,0.0531368     ,
  5.96302,0.0665809     ,
  6.05523,4.79389e-05   ,
  6.14271,0.0337525     ,
  6.27354,0.0530135     ,
  6.37381,0.0541951     ,
  6.45281,0.0182979     ,
  6.54298,0.0174799     ,
  6.66668,4.46403e-05   ,
  6.79700,4.46074e-05   ,
  6.84368,0.0166787     ,
  6.95743,4.55862e-05   ,
  7.34837,4.44686e-05   ,
  7.45516,0.0158862     ,
  7.54890,4.54340e-05      
};

//-----------------------------------------------------------------------------
const double npt_g4_0035 = 47;
double data_g4_0035[2*npt_g4_0035] = {
  0.0547983,0.00297070,
  0.116481,0.0117960  ,
  0.147812,0.0365311  ,
  0.209470,0.141814   ,
  0.311202,0.538090   ,
  0.432985,2.04147    ,
  0.504340,5.90626    ,
  0.605696,15.9643    ,
  0.757227,45.1338    ,
  1.00886,111.350	    ,
  1.22993,178.800	    ,
  1.46063,199.941	    ,
  1.75159,244.663	    ,
  2.02241,279.785	    ,
  2.25316,327.340	    ,
  2.50386,349.819	    ,
  2.68424,326.543	    ,
  2.98471,254.204	    ,
  3.22496,184.974	    ,
  3.42511,134.629	    ,
  3.57513,98.0139	    ,
  3.75513,65.1754	    ,
  3.99520,40.4829	    ,
  4.15507,25.1569	    ,
  4.28492,16.3590	    ,
  4.46474,9.28564	    ,
  4.67449,4.60123	    ,
  4.83414,2.33281	    ,
  5.02391,1.23723	    ,
  5.18355,0.627270    ,
  5.36320,0.303927    ,
  5.55295,0.157587    ,
  5.74287,0.0957221   ,
  5.87251,0.0519459   ,
  6.00259,0.0414029   ,
  6.25243,0.0205113   ,
  6.36286,0.0234770   ,
  6.59200,0.00646152  ,
  6.75255,0.00739368  ,
  6.88223,0.00410412  ,
  6.98263,0.00469779  ,
  7.04765,4.55629e-05 ,
  7.14232,0.00249195  ,
  7.26262,0.00249025  ,
  7.36224,0.00141415  ,
  7.43302,0.00243223  ,
  7.53890,4.64757e-05     
};

//-----------------------------------------------------------------------------
const double npt_g4_0105 = 45;
double data_g4_0105[2*npt_g4_0105] = {
0.0749488,0.00325155,
0.106582,0.0132087  ,
0.148038,0.0447758  ,
0.229746,0.173800   ,
0.321428,0.644749   ,
0.402809,1.86525    ,
0.484115,5.04222    ,
0.615821,17.4745    ,
0.767026,36.8211    ,
0.928280,79.3569    ,
1.18968,156.151	    ,
1.54101,234.124	    ,
1.87214,306.531	    ,
2.17286,299.168	    ,
2.41331,260.858	    ,
2.67351,173.382	    ,
2.97358,93.9992	    ,
3.28355,45.5113	    ,
3.57342,21.0632	    ,
3.84312,8.70719	    ,
4.14276,3.21409	    ,
4.34253,1.66642	    ,
4.57225,0.771500    ,
4.74198,0.409220    ,
4.97180,0.207390    ,
5.17154,0.105122    ,
5.30157,0.0800819   ,
5.51126,0.0379277   ,
5.59116,0.0289014   ,
5.75159,0.0295355   ,
5.96143,0.0160209   ,
6.18125,0.00830547  ,
6.26143,0.00811609  ,
6.36032,0.00239232  ,
6.45123,0.00440289  ,
6.56052,0.00182174  ,
6.65142,0.00335278  ,
6.75029,0.000966177 ,
6.84034,0.000824318 ,
6.95999,0.000457592 ,
7.05149,0.00144904  ,
7.15795,4.65759e-05 ,
7.43868,4.75655e-05 ,
7.49119,0.000407449 ,
7.65920,4.64441e-05            
};

//-----------------------------------------------------------------------------
const double npt_g4_0610 = 31;
double data_g4_0610[2*npt_g4_0610] = {
0.0849487,0.00317867,
0.0957526,0.00640682,
0.176958,0.0158215  ,
0.217912,0.0341217  ,
0.278816,0.0672179  ,
0.389719,0.118227   ,
0.500496,0.185714   ,
0.620972,0.217415   ,
0.811347,0.198400   ,
0.971269,0.128993   ,
1.11112,0.0820016   ,
1.22081,0.0487181   ,
1.32046,0.0282985   ,
1.44008,0.0153577   ,
1.55960,0.00761395  ,
1.67928,0.00432328  ,
1.77887,0.00240019  ,
1.87857,0.00145868  ,
1.95817,0.000847385 ,
2.06776,0.000459906 ,
2.11729,0.000267217 ,
2.19683,0.000148370 ,
2.24683,0.000132472 ,
2.35746,0.000181691 ,
2.44728,0.000126471 ,
2.52708,8.80386e-05 ,
2.57688,6.55978e-05 ,
2.66700,5.98946e-05 ,
2.74698,4.88439e-05 ,
2.84823,0.000120605 ,
2.97758,4.98958e-05 
};

//-----------------------------------------------------------------------------
const double npt_g4_0970 = 27;
double data_g4_0970[2*npt_g4_0970] = {
0.0542456,0.00180642  ,
0.104898,0.00290346   ,
0.145576,0.00488291   ,
0.166154,0.00784966   ,
0.276881,0.0117853    ,
0.317107,0.0131930    ,
0.457381,0.0123179    ,
0.517230,0.00938750   ,
0.586978,0.00638906   ,
0.646726,0.00444804   ,
0.716348,0.00270368   ,
0.805995,0.00160647   ,
0.855693,0.00109347   ,
0.925315,0.000664653  ,
0.984988,0.000432381  ,
1.02461,0.000281311   ,
1.08456,0.000234682   ,
1.15473,0.000234589   ,
1.18441,0.000163347   ,
1.23408,0.000108700   ,
1.24358,6.76056e-05   ,
1.24325,5.03874e-05   ,
1.24315,4.60301e-05   ,
1.34353,5.15105e-05   ,
1.43360,4.49525e-05   ,
1.58410,5.02904e-05   ,
1.65415,4.48965e-05   
};

//-----------------------------------------------------------------------------
const double npt_g4_1190 = 24;
double data_g4_1190[2*npt_g4_1190] = {
0.0837427,0.00107370  ,
0.0840693,0.00144060  ,
0.114622,0.00221336   ,
0.145174,0.00340062   ,
0.195626,0.00456138   ,
0.255901,0.00510562   ,
0.355925,0.00416315   ,
0.405724,0.00310197   ,
0.475497,0.00215946   ,
0.505069,0.00137363   ,
0.574842,0.000956263  ,
0.584415,0.000636490  ,
0.624163,0.000463674  ,
0.653786,0.000308587  ,
0.673409,0.000210082  ,
0.753960,0.000288185  ,
0.803583,0.000183294  ,
0.823055,0.000108953  ,
0.842753,7.93794e-05  ,
0.842402,5.78398e-05  ,
0.872275,4.82606e-05  ,
0.952450,4.71602e-05  ,
1.04290,5.77743e-05   ,
1.18298,4.50163e-05   
};

//-----------------------------------------------------------------------------
const double npt_g4_Z_0000 = 31;
double data_g4_Z_0000[2*npt_g4_Z_0000] = {
0.0801953,0.572558 ,
0.168442,1.11410   ,
0.294523,2.80842   ,
0.370032,6.33497   ,
0.483555,13.2740   ,
0.597158,23.9912   ,
0.774093,40.2836   ,
0.938489,54.1838   ,
1.10293,67.6874	   ,
1.28026,54.2694	   ,
1.55888,41.9521	   ,
1.79947,36.2269	   ,
2.12860,34.9655	   ,
2.36919,30.1937	   ,
2.64779,24.2196	   ,
2.91375,18.7215	   ,
3.11650,12.4790	   ,
3.36992,7.72718	   ,
3.68678,3.69512	   ,
4.07974,1.31515	   ,
4.30803,0.583851   ,
4.59973,0.207705   ,
4.81552,0.0686020  ,
5.03113,0.0316001  ,
5.23414,0.0130275  ,
5.41170,0.00695574 ,
5.55142,0.00286674 ,
5.75421,0.00177471 ,
5.99534,0.000564958,
6.16022,0.000312985,
6.27442,0.000186652
};

//-----------------------------------------------------------------------------
const double npt_g4_Z_0100 = 34;
double data_g4_Z_0100[2*npt_g4_Z_0100] = {
0.0420004,0.859624 ,
0.117409,2.33265   ,
0.218114,6.56888   ,
0.318898,15.9562   ,
0.432362,37.3542   ,
0.545925,72.6931   ,
0.710201,122.051   ,
0.925190,176.803   ,
1.07697,220.852	   ,
1.33013,221.111	   ,
1.76057,198.298	   ,
1.97584,171.216	   ,
2.26722,110.030	   ,
2.54600,63.2849	   ,
2.73613,39.1754	   ,
2.95158,24.2536	   ,
3.17981,12.0298	   ,
3.35735,6.66485	   ,
3.61093,3.07057	   ,
3.90261,1.13348	   ,
4.15635,0.388537   ,
4.41006,0.143401   ,
4.62571,0.0613481  ,
4.89205,0.0234962  ,
5.12034,0.0104310  ,
5.28522,0.00577873 ,
5.50073,0.00320215 ,
5.83036,0.00122678 ,
6.09656,0.000608586,
6.40078,0.000280448,
6.62917,0.000103495,
6.79401,6.17350e-05,
6.92093,3.29543e-05,
7.06037,2.27865e-05
};

//-----------------------------------------------------------------------------
const double npt_g4_Z_0200 = 32;
double data_g4_Z_0200[2*npt_g4_Z_0200] = {
0.0544983,1.15543  ,
0.167901,3.02211   ,
0.294043,6.81860   ,
0.382149,17.1853   ,
0.533667,34.7088   ,
0.622034,54.1046   ,
0.811687,81.3169   ,
1.07735,109.427	   ,
1.45717,94.5544	   ,
1.71058,60.7537	   ,
1.96412,30.1373	   ,
2.14168,16.0911	   ,
2.35727,7.69111	   ,
2.53486,3.81389	   ,
2.71242,2.03634	   ,
2.86476,0.903699   ,
3.02962,0.519497   ,
3.19459,0.239240   ,
3.35953,0.118628   ,
3.58786,0.0489114  ,
3.84146,0.0217164  ,
4.09519,0.00772425 ,
4.33607,0.00383144 ,
4.55160,0.00204607 ,
4.75447,0.00109258 ,
4.95731,0.000628185,
5.19815,0.000335503,
5.37567,0.000192877,
5.67999,7.38846e-05,
5.89564,3.16084e-05,
6.09873,1.12401e-05,
6.27622,6.70511e-06
};

//-----------------------------------------------------------------------------
const double npt_g4_Z_0300 = 33;
double data_g4_Z_0300[2*npt_g4_Z_0300] = {
0.0294223,0.741443 ,
0.142865,1.80111   ,
0.281725,3.63744   ,
0.433163,8.51693   ,
0.584741,15.3961   ,
0.850382,21.4984   ,
1.06561,19.9864	   ,
1.25569,13.8230	   ,
1.43318,8.24590	   ,
1.59808,4.40245	   ,
1.73766,2.35017	   ,
2.00404,0.835976   ,
2.16898,0.414522   ,
2.33396,0.190897   ,
2.44820,0.105731   ,
2.57506,0.0630577  ,
2.75276,0.0259932  ,
2.93037,0.0124219  ,
3.08261,0.00663160 ,
3.22205,0.00458547 ,
3.37435,0.00219109 ,
3.55191,0.00116988 ,
3.70400,0.000808971,
3.90700,0.000346065,
4.05903,0.000267363,
4.27462,0.000127793,
4.42678,7.90937e-05,
4.52821,5.88754e-05,
4.70568,3.64436e-05,
4.85792,1.94559e-05,
5.01002,1.34537e-05,
5.27622,6.67421e-06,
5.56772,3.43604e-06
};

//-----------------------------------------------------------------------------
const double npt_g4_Z_0400 = 32;
double data_g4_Z_0400[2*npt_g4_Z_0400] = {
0.0293822,0.798326 ,
0.130327,1.44280   ,
0.205996,2.42146   ,
0.319700,3.63808   ,
0.471358,5.67275   ,
0.648532,6.11297   ,
0.825807,5.47587   ,
0.965207,4.07682   ,
1.09201,2.71650	   ,
1.21891,1.50467	   ,
1.54879,0.369955   ,
1.66299,0.220626   ,
1.81533,0.0979110  ,
1.95487,0.0562781  ,
2.08181,0.0289513  ,
2.22139,0.0154552  ,
2.34832,0.00825000 ,
2.46250,0.00510522 ,
2.53867,0.00340096 ,
2.66549,0.00218393 ,
2.77974,0.00120961 ,
2.94471,0.000557051,
3.16032,0.000256595,
3.32520,0.000142153,
3.47734,9.12941e-05,
3.59150,5.86212e-05,
3.75634,3.49675e-05,
3.90864,1.67087e-05,
4.12397,1.29126e-05,
4.31410,7.99331e-06,
4.49146,6.17621e-06,
4.60550,4.95042e-06
};

//-----------------------------------------------------------------------------
const double npt_g4_Z_0500 = 28;
double data_g4_Z_0500[2*npt_g4_Z_0500] = {
0.0675171,0.594081 ,
0.105191,1.03441   ,
0.206196,1.67326   ,
0.408567,2.25103   ,
0.611078,2.33797   ,
0.763137,1.74074   ,
0.953350,0.929480  ,
1.11823,0.514929   ,
1.23253,0.255270   ,
1.38489,0.109175   ,
1.51189,0.0502686  ,
1.65157,0.0223072  ,
1.85469,0.00764470 ,
2.00713,0.00282018 ,
2.18466,0.00156247 ,
2.31154,0.000898035,
2.47654,0.000398559,
2.60346,0.000212752,
2.71769,0.000122273,
2.95859,5.84500e-05,
3.02218,3.35846e-05,
3.23759,2.23876e-05,
3.36448,1.28674e-05,
3.50398,7.96345e-06,
3.65620,4.41147e-06,
3.89706,2.27060e-06,
4.03650,1.57002e-06,
4.22666,9.36628e-07
};

//-----------------------------------------------------------------------------
const double npt_g4_Z_0600 = 29;
double data_g4_Z_0600[2*npt_g4_Z_0600] = {
0.0253566,0.655723 ,
0.0887480,0.914987 ,
0.177496,1.10103   ,
0.316957,1.14256   ,
0.456418,1.10103   ,
0.608558,0.760377  ,
0.773376,0.487644  ,
0.912837,0.269692  ,
0.988907,0.166673  ,
1.15372,0.0711361  ,
1.20444,0.0408256  ,
1.30586,0.0194710  ,
1.43265,0.00963658 ,
1.50872,0.00532952 ,
1.63550,0.00244944 ,
1.76228,0.00145877 ,
1.92710,0.000670450,
2.01585,0.000370793,
2.14263,0.000212801,
2.21870,0.000131514,
2.33281,8.43422e-05,
2.48494,5.40902e-05,
2.57369,4.02255e-05,
2.75119,2.48598e-05,
2.82726,1.48053e-05,
3.01743,7.89053e-06,
3.11886,4.36387e-06,
3.16957,3.36768e-06,
3.29636,2.15976e-06
};

//-----------------------------------------------------------------------------
const double npt_g4_Z_0700 = 22;
double data_g4_Z_0700[2*npt_g4_Z_0700] = {
0.0126783,0.631892 ,
0.114105,0.818810  ,
0.240887,0.732743  ,
0.405705,0.608928  ,
0.532488,0.452844  ,
0.659271,0.259891  ,
0.760697,0.138509  ,
0.874802,0.0660596 ,
1.01426,0.0292575  ,
1.19176,0.00690603 ,
1.25515,0.00426801 ,
1.33122,0.00203555 ,
1.45800,0.00100743 ,
1.58479,0.000599978,
1.64818,0.000344332,
1.76228,0.000158255,
1.90174,7.83232e-05,
2.04120,5.21245e-05,
2.18067,3.22135e-05,
2.37084,1.71683e-05,
2.51030,1.10103e-05,
2.63708,7.06114e-06
};

//-----------------------------------------------------------------------------
const double npt_g4_Z_0800 = 22;
double data_g4_Z_0800[2*npt_g4_Z_0800] = {
1.77636e-15,0.50603,
0.0507132,0.608928 ,
0.202853,0.565473  ,
0.329636,0.405244  ,
0.494453,0.250446  ,
0.583201,0.138509  ,
0.671949,0.0660596 ,
0.760697,0.0365343 ,
0.836767,0.0194710 ,
0.950872,0.00963658,
1.03962,0.00553051 ,
1.12837,0.00211232 ,
1.19176,0.00112576 ,
1.34390,0.000480476,
1.47068,0.000197615,
1.53407,9.78033e-05,
1.62282,4.66456e-05,
1.83835,3.22135e-05,
1.96513,1.84876e-05,
2.11727,1.06102e-05,
2.24406,6.08928e-06,
2.26941,3.90517e-06
};

//-----------------------------------------------------------------------------
const double npt_g4_Z_0900 = 20;
double data_g4_Z_0900[2*npt_g4_Z_0900] = {
0.0380349,0.506034 ,
0.164818,0.452844  ,
0.316957,0.290417  ,
0.443740,0.154778  ,
0.532488,0.0766027 ,
0.633914,0.0271696 ,
0.735341,0.0124871 ,
0.836767,0.00573908,
0.912837,0.00284038,
0.976228,0.00145877,
1.06498,0.000777455,
1.11569,0.000429972,
1.21712,0.000220827,
1.31854,0.000131514,
1.39461,7.54768e-05,
1.53407,4.33168e-05,
1.72425,1.91848e-05,
1.88907,1.06102e-05,
2.06656,6.80452e-06,
2.16799,3.76325e-06
};

//-----------------------------------------------------------------------------
double  interpolate_xsec(double *X, double* P) {

  double x, x1, x2, y1, y2, xmin, xmax, f;

  double* data;

  int     npt;

  if (P[0] == 10000) {
				// MARS 0 deg
    data = data_mars_0000; 
    npt = npt_mars_0000;
  }
  else if (P[0] == 10035) {
				// MARS 3.5 deg
    data = data_mars_0035; 
    npt = npt_mars_0035;
  }
  else if (P[0] == 10105) {
				// MARS 10.5 deg
    data = data_mars_0105; 
    npt = npt_mars_0105;
  }
  else if (P[0] == 10610) {
				// MARS 61 deg
    data = data_mars_0610; 
    npt = npt_mars_0610;
  }
  else if (P[0] == 10970) {
				// MARS 97 deg
    data = data_mars_0970; 
    npt = npt_mars_0970;
  }
  else if (P[0] == 11190) {
				// MARS 119 deg
    data = data_mars_1190; 
    npt = npt_mars_1190;
  }
  else if (P[0] == 20000) {
				// G4 0 deg
    data = data_g4_0000; 
    npt = npt_g4_0000;
  }
  else if (P[0] == 20000) {
				// G4 0 deg
    data = data_g4_0000; 
    npt = npt_g4_0000;
  }
  else if (P[0] == 20035) {
				// G4 3.5 deg
    data = data_g4_0035; 
    npt = npt_g4_0035;
  }
  else if (P[0] == 20105) {
				// G4 10.5 deg
    data = data_g4_0105; 
    npt = npt_g4_0105;
  }
  else if (P[0] == 20610) {
				// G4 61 deg
    data = data_g4_0610; 
    npt = npt_g4_0610;
  }
  else if (P[0] == 20970) {
				// G4 97 deg
    data = data_g4_0970; 
    npt = npt_g4_0970;
  }
  else if (P[0] == 21190) {
				// G4 119 deg
    data = data_g4_1190; 
    npt = npt_g4_1190;
  }
  else if (P[0] == 30000) {
				// G4 Z 0 deg
    data = data_g4_Z_0000; 
    npt = npt_g4_Z_0000;
  }
  else if (P[0] == 30100) {
				// G4 10 deg
    data = data_g4_Z_0100; 
    npt = npt_g4_Z_0100;
  }
  else if (P[0] == 30200) {
				// G4 20 deg
    data = data_g4_Z_0200; 
    npt  = npt_g4_Z_0200;
  }
  else if (P[0] == 30300) {
				// G4 Zhengyun 30 deg
    data = data_g4_Z_0300; 
    npt  = npt_g4_Z_0300;
  }
  else if (P[0] == 30400) {
				// G4 Zhengyun 30 deg
    data = data_g4_Z_0400; 
    npt  = npt_g4_Z_0400;
  }
  else if (P[0] == 30500) {
				// G4 Zhengyun 30 deg
    data = data_g4_Z_0500; 
    npt  = npt_g4_Z_0500;
  }
  else if (P[0] == 30600) {
				// G4 Zhengyun 30 deg
    data = data_g4_Z_0600; 
    npt  = npt_g4_Z_0600;
  }
  else if (P[0] == 30700) {
				// G4 Zhengyun 30 deg
    data = data_g4_Z_0700; 
    npt  = npt_g4_Z_0700;
  }
  else if (P[0] == 30800) {
				// G4 Zhengyun 30 deg
    data = data_g4_Z_0800; 
    npt  = npt_g4_Z_0800;
  }
  else if (P[0] == 30900) {
				// G4 Zhengyun 30 deg
    data = data_g4_Z_0900; 
    npt  = npt_g4_Z_0900;
  }

  x = X[0];

  xmin = data[0];
  xmax = data[2*(npt-1)];

  if ((x < xmin) || (x >= xmax)) {
    f = 0;
  }
  else {
//-----------------------------------------------------------------------------
// interpolate
//-----------------------------------------------------------------------------
    for (int i=0; i<npt; i++) {
      x1 = data[2*i];
      x2 = data[2*i+2];
      if ((x >= x1) && (x<x2)) {
	y1 = data[2*i+1];
	y2 = data[2*i+3];
	
	f = y1+(y2-y1)/(x2-x1)*(x-x1);
	break;
      }
    }
  }

  return f;
}




//-----------------------------------------------------------------------------
// normalization: without a scale factor
// f_low_stat ->Integral(0,1000) = 2.72236756905691992e-09
// f_high_stat->Integral(0,1000) = 6.56366640206827127e-09
//-----------------------------------------------------------------------------
void plot_all() {

  f_mars_00_deg = new TF1("f_mars_00_deg",interpolate_xsec,0,5,1);
  f_mars_00_deg->SetParameter(0,10000);

  f_mars_3_5_deg = new TF1("f_mars_3_5_deg",interpolate_xsec,0,5,1);
  f_mars_3_5_deg->SetParameter(0,10035);

  f_mars_10_5_deg = new TF1("f_mars_10_5_deg",interpolate_xsec,0,5,5);
  f_mars_10_5_deg->SetParameter(0,10105);

  f_mars_61_deg = new TF1("f_mars_61_deg",interpolate_xsec,0,5,1);
  f_mars_61_deg->SetParameter(0,10610);

  f_mars_97_deg = new TF1("f_mars_97_deg",interpolate_xsec,0,5,1);
  f_mars_97_deg->SetParameter(0,10970);

  f_mars_119_deg = new TF1("f_mars_119_deg",interpolate_xsec,0,5,1);
  f_mars_119_deg->SetParameter(0,11190);

  f_g4_00_deg = new TF1("f_g4_00_deg",interpolate_xsec,0,5,1);
  f_g4_00_deg->SetParameter(0,20000);

  f_g4_3_5_deg = new TF1("f_g4_3_5_deg",interpolate_xsec,0,5,1);
  f_g4_3_5_deg->SetParameter(0,20035);

  f_g4_10_5_deg = new TF1("f_g4_10_5_deg",interpolate_xsec,0,5,1);
  f_g4_10_5_deg->SetParameter(0,20105);

  f_g4_61_deg = new TF1("f_g4_61_deg",interpolate_xsec,0,5,1);
  f_g4_61_deg->SetParameter(0,20610);

  f_g4_97_deg = new TF1("f_g4_97_deg",interpolate_xsec,0,5,1);
  f_g4_97_deg->SetParameter(0,20970);

  f_g4_119_deg = new TF1("f_g4_119_deg",interpolate_xsec,0,5,1);
  f_g4_119_deg->SetParameter(0,21190);
//-----------------------------------------------------------------------------
// drawing
//-----------------------------------------------------------------------------
  TLegend* leg;

  TCanvas* c = new TCanvas("c","c",1200,700);
  c->Divide(3,2);

  c->cd(1);
  gPad->SetLogy(1);
  f_mars_00_deg->SetTitle("Pbars reaching TS (digitized from mu2e-3803)");
  f_mars_00_deg->GetXaxis()->SetTitle("Ptot, MeV/c");
  f_mars_00_deg->GetYaxis()->SetTitle("dN/dPtot/POT");

  f_mars_00_deg->GetYaxis()->SetRangeUser(1.e-3,1.e3);
  f_mars_00_deg->Draw();

  f_g4_00_deg->SetLineColor(4);
  f_g4_00_deg->Draw("same");

  leg = new TLegend(0.5,0.5,0.7,0.63,"0 deg");

  leg->AddEntry(f_mars_00_deg,"MARS" ,"f");
  leg->AddEntry(f_g4_00_deg  ,"G4"   ,"f");

  leg->SetFillColor(0);
  leg->SetBorderSize(0);
  leg->Draw();

  //-----------------------------------------------------------------------------
  c->cd(2);
  gPad->SetLogy(1);
  
  f_mars_3_5_deg->SetTitle("Pbars reaching TS (digitized from mu2e-3803)");
  f_mars_3_5_deg->GetXaxis()->SetTitle("Ptot, MeV/c");
  f_mars_3_5_deg->GetYaxis()->SetTitle("dN/dPtot/POT");
  f_mars_3_5_deg->GetYaxis()->SetRangeUser(1.e-3,1.e3);
  f_mars_3_5_deg->Draw();


  f_g4_3_5_deg->SetLineColor(4);
  f_g4_3_5_deg->Draw("same");

  leg = new TLegend(0.5,0.5,0.7,0.63,"3.5 deg");

  leg->AddEntry(f_mars_3_5_deg,"MARS" ,"f");
  leg->AddEntry(f_g4_3_5_deg  ,"G4"   ,"f");

  leg->SetFillColor(0);
  leg->SetBorderSize(0);
  leg->Draw();

  //-----------------------------------------------------------------------------
  c->cd(3);
  gPad->SetLogy(1);
  
  f_mars_10_5_deg->SetTitle("Pbars reaching TS (digitized from mu2e-3803)");
  f_mars_10_5_deg->GetXaxis()->SetTitle("Ptot, MeV/c");
  f_mars_10_5_deg->GetYaxis()->SetTitle("dN/dPtot/POT");
  f_mars_10_5_deg->GetYaxis()->SetRangeUser(1.e-3,1.e3);
  f_mars_10_5_deg->Draw();


  f_g4_10_5_deg->SetLineColor(4);
  f_g4_10_5_deg->Draw("same");

  leg = new TLegend(0.5,0.5,0.7,0.63,"10.5 deg");

  leg->AddEntry(f_mars_10_5_deg,"MARS" ,"f");
  leg->AddEntry(f_g4_10_5_deg  ,"G4"   ,"f");

  leg->SetFillColor(0);
  leg->SetBorderSize(0);
  leg->Draw();

  //-----------------------------------------------------------------------------
  c->cd(4);
  gPad->SetLogy(1);
  
  f_mars_61_deg->SetTitle("Pbars reaching TS (digitized from mu2e-3803)");
  f_mars_61_deg->GetXaxis()->SetTitle("Ptot, MeV/c");
  f_mars_61_deg->GetYaxis()->SetTitle("dN/dPtot/POT");

  f_mars_61_deg->GetYaxis()->SetRangeUser(1.e-6,1.e0);
  f_mars_61_deg->Draw();


  f_g4_61_deg->SetLineColor(4);
  f_g4_61_deg->Draw("same");

  leg = new TLegend(0.5,0.5,0.7,0.63,"61 deg");

  leg->AddEntry(f_mars_61_deg,"MARS" ,"f");
  leg->AddEntry(f_g4_61_deg  ,"G4"   ,"f");

  leg->SetFillColor(0);
  leg->SetBorderSize(0);
  leg->Draw();

//-----------------------------------------------------------------------------
  c->cd(5);
  gPad->SetLogy(1);
  
  f_mars_97_deg->SetTitle("Pbars reaching TS (digitized from mu2e-3803)");
  f_mars_97_deg->GetXaxis()->SetTitle("Ptot, MeV/c");
  f_mars_97_deg->GetYaxis()->SetTitle("dN/dPtot/POT");

  f_mars_97_deg->GetYaxis()->SetRangeUser(1.e-6,1.e-1);
  f_mars_97_deg->Draw();


  f_g4_97_deg->SetLineColor(4);
  f_g4_97_deg->Draw("same");

  leg = new TLegend(0.5,0.5,0.7,0.63,"97 deg");
  
  leg->AddEntry(f_mars_97_deg,"MARS" ,"f");
  leg->AddEntry(f_g4_97_deg  ,"G4"   ,"f");
  
  leg->SetFillColor(0);
  leg->SetBorderSize(0);
  leg->Draw();

//-----------------------------------------------------------------------------
  c->cd(6);
  gPad->SetLogy(1);
  
  f_mars_119_deg->SetTitle("Pbars reaching TS (digitized from mu2e-3803)");
  f_mars_119_deg->GetXaxis()->SetTitle("Ptot, MeV/c");
  f_mars_119_deg->GetYaxis()->SetTitle("dN/dPtot/POT");
  f_mars_119_deg->GetYaxis()->SetRangeUser(1.e-6,1.e-2);
  f_mars_119_deg->Draw();


  f_g4_119_deg->SetLineColor(4);
  f_g4_119_deg->Draw("same");

  leg = new TLegend(0.5,0.5,0.7,0.63,"119 deg");
  
  leg->AddEntry(f_mars_119_deg,"MARS" ,"f");
  leg->AddEntry(f_g4_119_deg  ,"G4"   ,"f");
  
  leg->SetFillColor(0);
  leg->SetBorderSize(0);
  leg->Draw();
}  

//-----------------------------------------------------------------------------
// iset = 30100, for example
//-----------------------------------------------------------------------------
void plot_iset(int ISet) {
  TF1* f;

  if (ISet == 30000) {
    f = new TF1("f_g4_Z_0000_deg",interpolate_xsec,0,8,1);
    f->SetParameter(0,30000);
  }
  else if (ISet == 30100) {
    f = new TF1("f_g4_Z_0100_deg",interpolate_xsec,0,8,1);
    f->SetParameter(0,30100);
  }
  else if (ISet == 30200) {
    printf("ISet = 30200\n");
    f = new TF1("f_g4_Z_0200_deg",interpolate_xsec,0,8,1);
    f->SetParameter(0,30200);
  }
  else if (ISet == 30300) {
    f = new TF1("f_g4_Z_0300_deg",interpolate_xsec,0,8,1);
    f->SetParameter(0,30300);
  }
  else if (ISet == 30400) {
    f = new TF1("f_g4_Z_0400_deg",interpolate_xsec,0,8,1);
    f->SetParameter(0,30400);
  }
  else if (ISet == 30500) {
    f = new TF1("f_g4_Z_0500_deg",interpolate_xsec,0,8,1);
    f->SetParameter(0,30500);
  }
  else if (ISet == 30600) {
    f = new TF1("f_g4_Z_0600_deg",interpolate_xsec,0,8,1);
    f->SetParameter(0,30600);
  }
  else if (ISet == 30700) {
    f = new TF1("f_g4_Z_0700_deg",interpolate_xsec,0,8,1);
    f->SetParameter(0,30700);
  }
  else if (ISet == 30800) {
    f = new TF1("f_g4_Z_0800_deg",interpolate_xsec,0,8,1);
    f->SetParameter(0,30800);
  }
  else if (ISet == 30900) {
    f = new TF1("f_g4_Z_0900_deg",interpolate_xsec,0,8,1);
    f->SetParameter(0,30900);
  }


  f->SetLineColor(kBlue-7);
  f->Draw("same");
}
