//

// closure approximation : dN/dx = (1 - 2x + 2x^2)*x* (1 - x)^2
// x = k/k_max
// k_max = 102.4

float data[] = {
  57.5, 55., 62.2637,  47.7643,
  58.5, 59., 66.6081,  51.2963,
  59.5, 82., 91.1429,  72.8505,
  60.5, 74., 82.6159,  65.5436,
  61.5, 74., 82.6244,  65.5531,
  62.5, 72., 80.4644,  63.3926,
  63.5, 71., 79.2554,  62.5890,
  64.5, 74., 82.3808,  65.4430,
  65.5, 75., 83.3373,  66.2645,
  66.5, 69., 77.1143,  60.8550,
  67.5, 58., 65.4689,  50.4291,
  68.5, 74., 82.5527,  65.3444,
  69.5, 46., 52.6150,  39.2011,
  70.5, 57., 64.6843,  49.6430,
  71.5, 34., 39.6256,  28.2432,
  72.5, 54., 61.3153,  46.8160,
  73.5, 39., 45.2000,  32.8681,
  74.5, 34., 39.6535,  28.2706,
  75.5, 27., 31.9380,  21.6406,
  76.5, 28., 33.3020,  22.7336,
  77.5, 22., 26.6715,  17.1856,
  78.5, 16., 19.7691,  11.6402,
  79.5, 26., 31.0259,  20.5921,
  80.5,  8., 10.4386,  5.01869,
  81.5, 10., 12.6161,  6.38315,
  82.5,  6.,  8.1526,  3.27565,
  83.5,  7.,  9.2460,  4.23262,
  84.5,  5.,  8.3065,  3.15711,
  85.5,  4.,  5.6065,  1.54060,
  86.5,  0.,  0.,   ,  0.     ,	
  87.5,  4.,  5.7590,  1.69355,
  88.5,  2.,  2.9230,  0.     ,	
  89.5,  1.,  1.5765,  0.     ,	
  90.5,  4.,  5.6509,  1.85747,	 
  91.5,  0.,  0.    ,  0.     ,   	 
  92.5,  0.,  0.    ,  0.     ,   	 
  93.5,  0.,  0.    ,  0.     ,   	 
  94.5,  0.,  0.    ,  0.     ,   	 
  95.5,  0.,  0.    ,  0.     ,   
  96.5,  1.,  1.6393,  0.     ,
  97.5,  1.,  1.6488,  0.     ,
  98.5,  0.,  0.    ,  0.     ,
  99.5,  1.,  1.6667,  0.     ,
 100.5,  0.,  0.    ,  0.     ,   	 
 101.5,  0.,  0.    ,  0.     ,   	 
 102.5,  0.,  0.    ,  0.     ,   	 
 103.5,  0.,  0.    ,  0.     ,   	 
 104.5,  0.,  0.    ,  0.     ,   	 
 105.5,  0.,  0.    ,  0.     ,   	 
 106.5,  0.,  0.    ,  0.     ,   	 
 107.5,  0.,  0.    ,  0.     ,   	 
 108.5,  0.,  0.    ,  0.     ,   
 109.5,  0.,  0.    ,  0.     ,
  -1 };

//-----------------------------------------------------------------------------
double rmc_momentum(double* X, double* P) {
  double f(0), x, k, kmax(102.4);

  k = X[0];

  if (k <= kmax) {
    x = k/kmax;
    f = P[0]*(1-2*x+2*x*x)*x*pow(1-x,P[1]);
  }

  return f;
}
//-----------------------------------------------------------------------------
void plot_rmc() {
  int bin;
  float y;
  
  TH1F* h = new TH1F("h_rmc","RMC photon momentum", 60,50,110);

  for (int i=0; data[4*i]>0; i++) {
    bin = data[4*i]-50+1;
    y   = data[4*i+1];
    h->SetBinContent(bin,y);
  }

  h->Draw();
  
  TF1* f_rmc = new TF1("f_rmc",rmc_momentum,0,110,2);

  f_rmc->SetParameter(0,1.2e4);
  f_rmc->SetParameter(1,4.);

  //  f_rmc->Draw("same");

  h->Fit(f_rmc,"","",65,110);
}

//-----------------------------------------------------------------------------
void plot_rmc_2() {
  int bin;
  float y;
  
  TH1F* h = new TH1F("h_rmc","RMC photon momentum", 60,50,110);

  for (int i=0; data[4*i]>0; i++) {
    bin = data[4*i]-50+1;
    y   = data[4*i+1];
    h->SetBinContent(bin,y);
  }

  h->Draw();
  
  TF1* f_rmc = new TF1("f_rmc",rmc_momentum,0,110,2);

  f_rmc->SetParameter(0,1.e3);
  f_rmc->SetParameter(1,2.);
  f_rmc->SetParError(1,0);
  f_rmc->FixParameter(1,2.);

  // f_rmc->Draw("same");

  h->Fit(f_rmc,"","",65,110);
}
