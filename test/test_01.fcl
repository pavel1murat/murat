# -*- mode: tcl -*-
# Example 1.
#
# $Id: test_01.fcl,v 1.1 2014/01/19 19:30:11 murat Exp $
# $Author: murat $
# $Id: test_01.fcl,v 1.1 2014/01/19 19:30:11 murat Exp $

#include "minimalMessageService.fcl"
#include "standardProducers.fcl"
#include "standardServices.fcl"

process_name : tcalm002

source : {
    module_type : RootInput
#    fileNames   : [ "/mu2e/data/users/murat/v4_0_6/conversion_01.root" ]
#    fileNames   : [ "/mu2e/app/users/murat/v4_0_6/piCapture_01.root" ]
    fileNames   : [ "/grid/data/mu2e/users/murat/piCapture_01.root" ]
#  fileNames   : [ "undefined" ]
#    maxEvents   : -1
}


outputs: {
    outfile : {
	module_type    : RootOutput
	fileName       : "DATASET.JOB.strip.root"
#	SelectEvents  : { SelectEvents: [ p1 ] }
	outputCommands : ['keep *_*_*_*'
			  # , 'drop mu2ePointTrajectoryMapVector_*_*_*'
			  # , 'drop mu2eSimParticles_*_*_*'
			  # Uncomment the above line to reduce file size.
			 ]
    }
}

services : {
    message               : @local::default_message
    RandomNumberGenerator : { }
    TFileService          : { fileName : "DATASET.trkpatrec.hist"}
    
    user : {
#	GeometryService        : { inputFile      : "murat/test/geom_01.txt"        }
	GeometryService        : { inputFile      : "Mu2eG4/test/geom_01.txt"        }
	ConditionsService      : { conditionsfile : "Mu2eG4/test/conditions_01.txt"      }
	GlobalConstantsService : { inputFile      : "Mu2eG4/test/globalConstants_01.txt" }
	SeedService            : @local::automaticSeeds
    }
}

physics : {
  producers : {
    MakeStereoHits : @local::MakeStereoHits
    FlagStrawHits  : @local::FlagStrawHits
    FlagBkgHits    : @local::FlagBkgHits
      
    TrkPatRecDem   : @local::TrkPatRecDownstreameMinus

    CaloCrystalHitsMaker : @local::CaloCrystalHitsMaker

    makeCaloCluster: {
	module_type                   : MakeCaloClusterNew
	diagLevel                     : 0
	generatorModuleLabel          : generate
	caloCrystalModuleLabel        : CaloCrystalHitsMaker
	g4ModuleLabel                 : g4run
	#caloReadoutModuleLabel: CaloReadoutHitsMaker
	caloClusterAlgorithm          : closest
	caloClusterSeeding            : energy
	#     caloClusterSeeding    : time
	deltaTime                     : 10.0 # ns
	nCryPerCrystal                : 1
	EnoiseCut                     : 0.00 # MeV
	EclusterCut                   : 0.00 # MeV  
	maxFullPrint                  : 201
    }

  }
#------------------------------------------------------------------------------
# path configuration
#------------------------------------------------------------------------------  
  p1 : [ CaloCrystalHitsMaker
         # , makeCaloCluster, MakeStereoHits, FlagStrawHits, FlagBkgHits, TrkPatRecDem, 
         # trkExtrapol, caloMatching
	 # , PidDem
	 # , tcalm002 
       ]

  e1 : [ outfile ]

  trigger_paths  : []
 #  trigger_paths  : [p1]

  #  end_paths      : [e1]
  end_paths      : []
}

#------------------------------------------------------------------------------
# redefinitions
# --------------
# 1. Initialze seeding of random engines, mu2eart redefines the seed service data
#------------------------------------------------------------------------------
services.user.SeedService.baseSeed         :  0
services.user.SeedService.maxUniqueEngines :  20

# print per event timing for ::event entry points
services.Timing: { }
# print 
services.scheduler.wantSummary: true

physics.producers.CaloCrystalHitsMaker.minimumEnergy : 0
