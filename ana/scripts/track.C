///////////////////////////////////////////////////////////////////////////////
// 
///////////////////////////////////////////////////////////////////////////////
#include "murat/ana/scripts/modules.hh"

def_name track_001("track_ana");
def_name track_002("val_cpr");
def_name track_004("cal_ana");
def_name track_005("track_ana_tandip_12");
def_name track_006("track_debug_tandip_12");
def_name track_007("track_ana_dem");
def_name track_007("track_ana_dmm");
def_name track_008("track_ana_ump");
def_name track_008("track_ana_umm");
def_name track_011("track_ana_nocorr");

def_name track_051("track_comp");
def_name track_052("track_comp_tmva");
def_name track_053("track_comp_use_mva");

def_name track_100("track_anaB");
///////////////////////////////////////////////////////////////////////////////

//-----------------------------------------------------------------------------
void  track_ana(int PdgCode = 11, int GeneratorCode = 2, int DebugBit = -1) {
//-----------------------------------------------------------------------------
// configure analysis module
//-----------------------------------------------------------------------------
  m_trk = (TTrackAnaModule*) g.x->AddModule("TTrackAnaModule",0);  
  m_trk->SetPdgCode      (PdgCode);
  m_trk->SetGeneratorCode(GeneratorCode);
  if (DebugBit >= 0) {
    m_trk->SetDebugBit(DebugBit,1);
  }
}

//-----------------------------------------------------------------------------
void  track_ana_nocorr(int PdgCode = 11, int GeneratorCode = 2, int DebugBit = -1) {
//-----------------------------------------------------------------------------
// configure analysis module
//-----------------------------------------------------------------------------
  m_trk = (TTrackAnaModule*) g.x->AddModule("TTrackAnaModule",0);  
  m_trk->SetPdgCode      (PdgCode);
  m_trk->SetGeneratorCode(GeneratorCode);
  m_trk->SetApplyCorrections(0);
  if (DebugBit >= 0) {
    m_trk->SetDebugBit(DebugBit,1);
  }
}

//-----------------------------------------------------------------------------
void  track_ana_dmm(int PdgCode = 13) {
//-----------------------------------------------------------------------------
// configure analysis module to handle signal muons reconstructed as muons
// generated by SingleParticleReactionGun
//-----------------------------------------------------------------------------
  m_trk = (TTrackAnaModule*) g.x->AddModule("TTrackAnaModule",0);  
  m_trk->SetTrackBlockName("TrackBlockDmm");
  m_trk->SetPdgCode(PdgCode);
  m_trk->SetDirection(1);
  m_trk->SetGeneratorCode(28);
}

//-----------------------------------------------------------------------------
void  track_ana_dem(int PdgCode = 11) {
//-----------------------------------------------------------------------------
// configure analysis module to handle signal muons reconstructed as muons
// generated by SingleParticleReactionGun
//-----------------------------------------------------------------------------
  m_trk = (TTrackAnaModule*) g.x->AddModule("TTrackAnaModule",0);  
  m_trk->SetTrackBlockName("TrackBlockDem");
  m_trk->SetTrackStrawHitBlockName("TrackHitBlockDem");
  m_trk->SetPdgCode(PdgCode);
  m_trk->SetDirection(1);
  m_trk->SetGeneratorCode(28);
}

//-----------------------------------------------------------------------------
void  track_ana_ump() {
//-----------------------------------------------------------------------------
// configure analysis module to handle signal muons reconstructed as muons
// generated by SingleParticleReactionGun
//-----------------------------------------------------------------------------
  m_trk = (TTrackAnaModule*) g.x->AddModule("TTrackAnaModule",0);  
  m_trk->SetTrackBlockName("TrackBlockUmp");
  m_trk->SetPdgCode(-13);
  m_trk->SetDirection(-1);
  m_trk->SetGeneratorCode(28);
}

//-----------------------------------------------------------------------------
void  track_ana_umm() {
//-----------------------------------------------------------------------------
// configure analysis module to handle signal muons reconstructed as muons
// generated by SingleParticleReactionGun
//-----------------------------------------------------------------------------
  m_trk = (TTrackAnaModule*) g.x->AddModule("TTrackAnaModule",0);  
  m_trk->SetTrackBlockName("TrackBlockUmm");
  m_trk->SetPdgCode(13);
  m_trk->SetDirection(-1);
  m_trk->SetGeneratorCode(28);
}

//-----------------------------------------------------------------------------
void  track_ana_tandip_12(int GeneratorCode = 2) {
  m_trk = (TTrackAnaModule*) g.x->AddModule("TTrackAnaModule",0);  
  m_trk->GetTrackID()->SetMinTanDip(1.);
  m_trk->GetTrackID()->SetMaxTanDip(2.);
}

//-----------------------------------------------------------------------------
// GeneratorCode= 2:ConversionElectronGun 28:ParticleGun
//-----------------------------------------------------------------------------
void  track_anaB(int PdgCode = 11, int GeneratorCode = 2, const char* DebugBits) {

  m_trka = (TTrackAnaModuleA*) g.x->AddModule("TTrackAnaModuleA",0);  
  m_trka->SetPdgCode(PdgCode);
  m_trka->SetGeneratorCode(GeneratorCode);
  if (DebugBit >= 0) {
    m_trka->SetDebugBit(DebugBit,1);
  }
}

//-----------------------------------------------------------------------------
void  val_cpr(int Bit = -1) {
//-----------------------------------------------------------------------------
// configure analysis modules
//-----------------------------------------------------------------------------
  m_vcpr = (TValCalPatRecModule*) g.x->AddModule("TValCalPatRecModule",0);  

  if (Bit != -1) {
    m_vcpr->SetDebugBit(Bit,1);
  }
}


//-----------------------------------------------------------------------------
void  track_debug_tandip_12(int Bit, int GeneratorCode = 2) {
  m_trk = (TTrackAnaModule*) g.x->AddModule("TTrackAnaModule",0);  
  m_trk->GetTrackID()->SetMinTanDip(1.);
  m_trk->GetTrackID()->SetMaxTanDip(2.);
  m_trk->SetDebugBit(Bit,1);
}

//-----------------------------------------------------------------------------
void  cal_ana() {
//-----------------------------------------------------------------------------
// configure analysis module
//-----------------------------------------------------------------------------
  m_cal = (TCalAnaModule*) g.x->AddModule("TCalAnaModule",0);  
}

//-----------------------------------------------------------------------------
// GeneratorCode= 2:ConversionElectronGun 28:ParticleGun
//-----------------------------------------------------------------------------
void  track_comp(int PDGCode=11, int GeneratorCode=28, int DebugBit = -1, double XMin=1,double XMax = -1) {
//-----------------------------------------------------------------------------
// configure analysis module
//-----------------------------------------------------------------------------
  m_tcm = (TTrackCompModule*) g.x->AddModule("TTrackCompModule",0);  
  m_tcm->SetPdgCode      (PDGCode);
  m_tcm->SetGeneratorCode(GeneratorCode);
  if (DebugBit >= 0) {
    m_tcm->SetDebugBit(DebugBit,1);
    if (XMin < XMax) m_tcm->SetDebugCut(DebugBit,XMin,XMax);
  }
}

//-----------------------------------------------------------------------------
// GeneratorCode= 2:ConversionElectronGun 28:ParticleGun
// TrkRrecoAlg = 0:TrkPatRec    =1:CalPatRec
//-----------------------------------------------------------------------------
void  track_comp_tmva(int PDGCode=11, int GeneratorCode=28, int TrkRecoAlg = 0, int DebugBit = -1) {
//-----------------------------------------------------------------------------
// configure analysis module to write TMVA training trees
//-----------------------------------------------------------------------------
  m_tcm = (TTrackCompModule*) g.x->AddModule("TTrackCompModule",0);  
  m_tcm->SetPdgCode      (11);
  m_tcm->SetGeneratorCode(GeneratorCode);

  m_tcm->SetWriteTmvaTree(TrkRecoAlg);

  if (DebugBit >= 0) m_tcm->SetDebugBit(DebugBit,1);
}

//-----------------------------------------------------------------------------
// GeneratorCode= 2:ConversionElectronGun 28:ParticleGun
// MVAMode : 100 + Mode (chi2)
//         :       Mode (logfcons)
//-----------------------------------------------------------------------------
void  track_comp_use_mva(int PDGCode=11, int GeneratorCode=28, int TprMva = -1, int CprMvaType = 202, int DebugBit = -1) {
//-----------------------------------------------------------------------------
// configure analysis module to write TMVA training trees
//-----------------------------------------------------------------------------
  m_tcm = (TTrackCompModule*) g.x->AddModule("TTrackCompModule",0);  
  m_tcm->SetPdgCode      (11);
  m_tcm->SetGeneratorCode(GeneratorCode);

  m_tcm->SetMVA("calpatrec","e11s5731",CprMvaType);

  if (DebugBit >= 0) m_tcm->SetDebugBit(DebugBit,1);
}

