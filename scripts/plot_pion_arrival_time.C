///////////////////////////////////////////////////////////////////////////////
// mu2e-docdb 1488 , histogram fig. 14
///////////////////////////////////////////////////////////////////////////////

/*
root [5] f_all->Integral(0,1500)
(Double_t)1.75112209486875268e-05
*/

namespace {
  TF1* f_all;
};

double  pion_arrival_time(double *X, double* P) {
  const double npt = 115;

  double data[2*npt] = {
    53.9346,1.00318e-29,
    63.3453,8.03217e-09,
    74.5760,1.15298e-08,
    83.5479,3.66001e-08,
    94.7786,5.25378e-08,
    103.761,8.10478e-08,
    113.869,1.08233e-07,
    123.980,1.16403e-07,
    132.964,1.67069e-07,
    146.446,1.79716e-07,
    156.559,1.67306e-07,
    164.425,1.67385e-07,
    176.786,1.44998e-07,
    184.654,1.25571e-07,
    193.646,9.41384e-08,
    207.133,7.58755e-08,
    216.126,5.68826e-08,
    225.120,3.96752e-08,
    232.988,3.19674e-08,
    246.476,2.23030e-08,
    254.348,1.44722e-08,
    264.468,8.73825e-09,
    274.585,6.09527e-09,
    284.704,3.95569e-09,
    293.700,2.38827e-09,
    303.821,1.34164e-09,
    316.188,8.10184e-10,
    325.183,5.25755e-10,
    335.304,2.95349e-10,
    345.424,1.65915e-10,
    354.420,1.00172e-10,
    365.666,5.23586e-11,
    373.537,3.39750e-11,
    384.781,2.05153e-11,
    396.026,1.07231e-11,
    405.022,6.47412e-12,
    416.265,3.90932e-12,
    424.137,2.53671e-12,
    435.381,1.42512e-12,
    445.503,7.44842e-13,
    456.746,4.49763e-13,
    464.619,2.71528e-13,
    476.987,1.52555e-13,
    484.858,9.89910e-14,
    493.856,5.56055e-14,
    506.224,3.12412e-14,
    517.466,2.02762e-14,
    527.588,1.05974e-14,
    537.706,6.87745e-15,
    544.455,4.15174e-15,
    555.700,2.33244e-15,
    565.818,1.51370e-15,
    575.939,8.50337e-16,
    586.058,5.51849e-16,
    593.931,3.09965e-16,
    606.297,2.01188e-16,
    615.296,9.78238e-17,
    625.411,8.47287e-17,
    635.535,3.83322e-17,
    646.776,2.67400e-17,
    655.772,1.61444e-17,
    665.894,8.43792e-18,
    676.014,5.09478e-18,
    685.007,3.81948e-18,
    695.125,2.47875e-18,
    704.122,1.39237e-18,
    713.123,6.29882e-19,
    725.484,5.45637e-19,
    735.607,2.65324e-19,
    745.725,1.85074e-19,
    755.845,1.11747e-19,
    765.964,6.74724e-20,
    776.084,4.07396e-20,
    787.330,1.98116e-20,
    796.326,1.28564e-20,
    806.440,1.11354e-20,
    815.432,8.97268e-21,
    825.555,4.36310e-21,
    837.925,2.12191e-21,
    844.661,3.04508e-21,
    859.283,1.10977e-21,
    877.276,3.76370e-22,
    884.025,2.27205e-22,
    895.269,1.27643e-22,
    902.009,1.47520e-22,
    915.497,1.02922e-22,
    926.750,3.24621e-23,
    935.749,1.57841e-23,
    946.995,8.25013e-24,
    954.858,9.53553e-24,
    964.977,5.75751e-24,
    976.220,3.73675e-24,
    985.214,2.60635e-24,
    995.332,1.69146e-24,
    1005.46,4.29619e-25,
    1015.60,1.17285e-25,
    1025.69,5.74074e-25,
    1035.82,1.68448e-25,
    1047.05,1.94733e-25,
    1057.16,1.81286e-25,
    1066.17,4.28367e-26,
    1075.16,3.70999e-26,
    1085.28,2.08413e-26,
    1094.29,4.92466e-27,
    1104.40,7.59758e-27,
    1112.28,3.69394e-27,
    1123.50,7.60631e-27,
    1134.73,1.68344e-26,
    1143.74,2.98053e-27,
    1154.99,1.25464e-27,
    1165.17,1.23902e-29,
    1172.97,7.05138e-28,
    1184.23,1.24862e-28,
    1195.50,2.21097e-29,
    1204.50,1.07505e-29
  };

  double x, x1, x2, y1, y2, xmin, xmax, f;

  x = X[0];

  xmin = data[0];
  xmax = data[2*(npt-1)];

  if ((x < xmin) || (x >= xmax)) {
    f = 0;
  }
  else {
//-----------------------------------------------------------------------------
// interpolate
//-----------------------------------------------------------------------------
    for (int i=0; i<npt; i++) {
      x1 = data[2*i];
      x2 = data[2*i+2];
      if ((x >= x1) && (x<x2)) {
	y1 = data[2*i+1];
	y2 = data[2*i+3];
	
	f = y1+(y2-y1)/(x2-x1)*(x-x1);
	break;
      }
    }
  }

  return f;
}



void plot_pion_arrival_time() {

  f_all = new TF1("f_all",pion_arrival_time,0,1500,0);

  f_all->Draw();
}  
